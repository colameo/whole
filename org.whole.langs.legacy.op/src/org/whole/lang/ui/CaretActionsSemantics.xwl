<?xml version="1.0"?>
<semantics:SemanticTheory xmlns:semantics="http://lang.whole.org/Semantics">
    <semantics:URI value="whole:org.whole.lang.ui:CaretActionsSemantics"/>
    <semantics:Namespace value="org.whole.lang.ui"/>
    <semantics:Name value="CaretActions"/>
    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
    <semantics:SemanticFunctions initialCapacity="16">
        <semantics:SemanticFunction>
            <semantics:Name value="splitOnCaretEnabled"/>
            <semantics:FunctionType>
                <semantics:AnyType/>
                <semantics:LegacyType value="BOOLEAN"/>
            </semantics:FunctionType>
            <semantics:Rules initialCapacity="1">
                <semantics:ExecutionRule>
                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                    <semantics:AnyType/>
                    <queries:Choose xmlns:queries="http://lang.whole.org/Queries" initialCapacity="2">
                        <queries:If>
                            <queries:ExpressionTest>
                                <queries:Filter>
                                    <queries:VariableRefStep value="focusEntity"/>
                                    <queries:And initialCapacity="2">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                    </queries:And>
                                </queries:Filter>
                            </queries:ExpressionTest>
                            <queries:BooleanLiteral value="true"/>
                        </queries:If>
                        <queries:Do>
                            <queries:BooleanLiteral value="false"/>
                        </queries:Do>
                    </queries:Choose>
                </semantics:ExecutionRule>
            </semantics:Rules>
        </semantics:SemanticFunction>
        <semantics:SemanticFunction>
            <semantics:Name value="splitOnCaret"/>
            <semantics:FunctionType>
                <semantics:AnyType/>
                <semantics:AnyType/>
            </semantics:FunctionType>
            <semantics:Rules initialCapacity="1">
                <semantics:ExecutionRule>
                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                    <semantics:AnyType/>
                    <queries:Scope xmlns:queries="http://lang.whole.org/Queries">
                        <queries:Names initialCapacity="2">
                            <queries:Name value="focusEntityURI"/>
                            <queries:Name value="newEntity"/>
                        </queries:Names>
                        <queries:Block initialCapacity="5">
                            <queries:Path initialCapacity="3">
                                <queries:VariableRefStep value="focusEntity"/>
                                <semantics:FunctionApplication>
                                    <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                </semantics:FunctionApplication>
                                <queries:Filter>
                                    <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#entityURI"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    </semantics:FunctionApplication>
                                    <queries:VariableTest value="focusEntityURI"/>
                                </queries:Filter>
                            </queries:Path>
                            <queries:Filter>
                                <workflows:CreateEntity xmlns:workflows="http://lang.whole.org/Workflows">
                                    <workflows:Text value="rightText"/>
                                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    <workflows:Registry value="DEFAULT"/>
                                    <workflows:Variable value="focusEntityURI"/>
                                    <workflows:Expressions initialCapacity="1">
                                        <workflows:Variable value="rightText"/>
                                    </workflows:Expressions>
                                </workflows:CreateEntity>
                                <queries:VariableTest value="newEntity"/>
                            </queries:Filter>
                            <queries:PointwiseUpdate>
                                <queries:VariableRefStep value="focusEntity"/>
                                <workflows:CreateEntity xmlns:workflows="http://lang.whole.org/Workflows">
                                    <workflows:Text value="leftText+selectedText"/>
                                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    <workflows:Registry value="DEFAULT"/>
                                    <workflows:Variable value="focusEntityURI"/>
                                    <workflows:Expressions initialCapacity="1">
                                        <queries:Addition>
                                        <queries:VariableRefStep value="leftText"/>
                                        <queries:VariableRefStep value="selectedText"/>
                                        </queries:Addition>
                                    </workflows:Expressions>
                                </workflows:CreateEntity>
                            </queries:PointwiseUpdate>
                            <queries:PointwiseUpdate>
                                <queries:VariableRefStep value="caretPosition"/>
                                <queries:IntLiteral value="0"/>
                            </queries:PointwiseUpdate>
                            <queries:Choose initialCapacity="2">
                                <queries:CartesianInsert>
                                    <queries:Placement value="BEFORE"/>
                                    <queries:Path initialCapacity="2">
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:Filter>
                                        <queries:FollowingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                    </queries:Path>
                                    <queries:VariableRefStep value="newEntity"/>
                                </queries:CartesianInsert>
                                <queries:CartesianInsert>
                                    <queries:Placement value="INTO"/>
                                    <queries:Path initialCapacity="2">
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:ParentStep/>
                                    </queries:Path>
                                    <queries:VariableRefStep value="newEntity"/>
                                </queries:CartesianInsert>
                            </queries:Choose>
                        </queries:Block>
                    </queries:Scope>
                </semantics:ExecutionRule>
            </semantics:Rules>
        </semantics:SemanticFunction>
        <semantics:SemanticFunction>
            <semantics:Name value="newlineEnabled"/>
            <semantics:FunctionType>
                <semantics:AnyType/>
                <semantics:LegacyType value="BOOLEAN"/>
            </semantics:FunctionType>
            <semantics:Rules initialCapacity="1">
                <semantics:ExecutionRule>
                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                    <semantics:AnyType/>
                    <queries:Choose xmlns:queries="http://lang.whole.org/Queries" initialCapacity="2">
                        <queries:If>
                            <queries:ExpressionTest>
                                <queries:Filter>
                                    <queries:VariableRefStep value="focusEntity"/>
                                    <queries:And initialCapacity="2">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:And initialCapacity="2">
                                        <queries:KindTest value="COMPOSITE"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        </queries:And>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                    </queries:And>
                                </queries:Filter>
                            </queries:ExpressionTest>
                            <queries:BooleanLiteral value="true"/>
                        </queries:If>
                        <queries:Do>
                            <queries:BooleanLiteral value="false"/>
                        </queries:Do>
                    </queries:Choose>
                </semantics:ExecutionRule>
            </semantics:Rules>
        </semantics:SemanticFunction>
        <semantics:SemanticFunction>
            <semantics:Name value="newline"/>
            <semantics:FunctionType>
                <semantics:AnyType/>
                <semantics:AnyType/>
            </semantics:FunctionType>
            <semantics:Rules initialCapacity="1">
                <semantics:ExecutionRule>
                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                    <semantics:AnyType/>
                    <queries:Scope xmlns:queries="http://lang.whole.org/Queries">
                        <queries:Names initialCapacity="4">
                            <queries:Name value="focusEntityURI"/>
                            <queries:Name value="parentFocusEntityURI"/>
                            <queries:Name value="newEntity"/>
                            <queries:Name value="newEntityContainer"/>
                        </queries:Names>
                        <queries:Block initialCapacity="9">
                            <queries:Path initialCapacity="3">
                                <queries:VariableRefStep value="focusEntity"/>
                                <semantics:FunctionApplication>
                                    <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                </semantics:FunctionApplication>
                                <queries:Filter>
                                    <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#entityURI"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    </semantics:FunctionApplication>
                                    <queries:VariableTest value="focusEntityURI"/>
                                </queries:Filter>
                            </queries:Path>
                            <queries:Filter>
                                <workflows:CreateEntity xmlns:workflows="http://lang.whole.org/Workflows">
                                    <workflows:Text value="rightText"/>
                                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    <workflows:Registry value="DEFAULT"/>
                                    <workflows:Variable value="focusEntityURI"/>
                                    <workflows:Expressions initialCapacity="1">
                                        <workflows:Variable value="rightText"/>
                                    </workflows:Expressions>
                                </workflows:CreateEntity>
                                <queries:VariableTest value="newEntity"/>
                            </queries:Filter>
                            <queries:Path initialCapacity="4">
                                <queries:VariableRefStep value="focusEntity"/>
                                <queries:ParentStep/>
                                <semantics:FunctionApplication>
                                    <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                </semantics:FunctionApplication>
                                <queries:Filter>
                                    <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#entityURI"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    </semantics:FunctionApplication>
                                    <queries:VariableTest value="parentFocusEntityURI"/>
                                </queries:Filter>
                            </queries:Path>
                            <queries:Filter>
                                <workflows:CreateEntity xmlns:workflows="http://lang.whole.org/Workflows">
                                    <workflows:Text value="rigtText"/>
                                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    <workflows:Registry value="DEFAULT"/>
                                    <workflows:Variable value="parentFocusEntityURI"/>
                                    <workflows:Expressions initialCapacity="1">
                                        <workflows:Variable value="newEntity"/>
                                    </workflows:Expressions>
                                </workflows:CreateEntity>
                                <queries:VariableTest value="newEntityContainer"/>
                            </queries:Filter>
                            <queries:CartesianInsert>
                                <queries:Placement value="INTO"/>
                                <queries:VariableRefStep value="newEntityContainer"/>
                                <queries:Delete>
                                    <queries:Path initialCapacity="2">
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:FollowingSiblingStep/>
                                    </queries:Path>
                                </queries:Delete>
                            </queries:CartesianInsert>
                            <queries:PointwiseUpdate>
                                <queries:VariableRefStep value="focusEntity"/>
                                <workflows:CreateEntity xmlns:workflows="http://lang.whole.org/Workflows">
                                    <workflows:Text value="leftText+selectedText"/>
                                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    <workflows:Registry value="DEFAULT"/>
                                    <workflows:Variable value="focusEntityURI"/>
                                    <workflows:Expressions initialCapacity="1">
                                        <queries:VariableRefStep value="leftText"/>
                                    </workflows:Expressions>
                                </workflows:CreateEntity>
                            </queries:PointwiseUpdate>
                            <queries:Choose initialCapacity="2">
                                <queries:CartesianInsert>
                                    <queries:Placement value="BEFORE"/>
                                    <queries:Path initialCapacity="3">
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:ParentStep/>
                                        <queries:Filter>
                                        <queries:FollowingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                    </queries:Path>
                                    <queries:VariableRefStep value="newEntityContainer"/>
                                </queries:CartesianInsert>
                                <queries:CartesianInsert>
                                    <queries:Placement value="INTO"/>
                                    <queries:Path initialCapacity="3">
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:ParentStep/>
                                        <queries:ParentStep/>
                                    </queries:Path>
                                    <queries:VariableRefStep value="newEntityContainer"/>
                                </queries:CartesianInsert>
                            </queries:Choose>
                            <queries:PointwiseUpdate>
                                <queries:VariableRefStep value="caretPosition"/>
                                <queries:IntLiteral value="0"/>
                            </queries:PointwiseUpdate>
                            <queries:VariableRefStep value="newEntity"/>
                        </queries:Block>
                    </queries:Scope>
                </semantics:ExecutionRule>
            </semantics:Rules>
        </semantics:SemanticFunction>
        <semantics:SemanticFunction>
            <semantics:Name value="backspaceEnabled"/>
            <semantics:FunctionType>
                <semantics:AnyType/>
                <semantics:LegacyType value="BOOLEAN"/>
            </semantics:FunctionType>
            <semantics:Rules initialCapacity="1">
                <semantics:ExecutionRule>
                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                    <semantics:AnyType/>
                    <queries:Scope xmlns:queries="http://lang.whole.org/Queries">
                        <queries:Names initialCapacity="1">
                            <queries:Name value="hasPrecedingSiblingWithSameType"/>
                        </queries:Names>
                        <queries:Block initialCapacity="2">
                            <queries:QueryDeclaration>
                                <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                <queries:CartesianProduct initialCapacity="2">
                                    <queries:Path initialCapacity="2">
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                        <queries:Filter>
                                        <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </semantics:FunctionApplication>
                                        <queries:VariableTest value="type"/>
                                        </queries:Filter>
                                    </queries:Path>
                                    <queries:Filter>
                                        <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </semantics:FunctionApplication>
                                        <queries:VariableTest value="type"/>
                                    </queries:Filter>
                                </queries:CartesianProduct>
                            </queries:QueryDeclaration>
                            <queries:Choose initialCapacity="6">
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:NotEquals>
                                        <queries:VariableRefStep value="caretPosition"/>
                                        <queries:IntLiteral value="0"/>
                                        </queries:NotEquals>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:NotEquals>
                                        <queries:VariableRefStep value="caretPositionStart"/>
                                        <queries:VariableRefStep value="caretPositionEnd"/>
                                        </queries:NotEquals>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:And initialCapacity="4">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                        </queries:ExpressionTest>
                                        <queries:Not>
                                        <queries:ExpressionTest>
                                        <queries:Call>
                                        <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Call>
                                        </queries:ExpressionTest>
                                        </queries:Not>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:And initialCapacity="3">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        <queries:ExpressionTest>
                                        <queries:Call>
                                        <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Call>
                                        </queries:ExpressionTest>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="true"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:And initialCapacity="2">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:And initialCapacity="3">
                                        <queries:KindTest value="COMPOSITE"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        <queries:ExpressionTest>
                                        <queries:Call>
                                        <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Call>
                                        </queries:ExpressionTest>
                                        </queries:And>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="true"/>
                                </queries:If>
                                <queries:Do>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:Do>
                            </queries:Choose>
                        </queries:Block>
                    </queries:Scope>
                </semantics:ExecutionRule>
            </semantics:Rules>
        </semantics:SemanticFunction>
        <semantics:SemanticFunction>
            <semantics:Name value="backspace"/>
            <semantics:FunctionType>
                <semantics:AnyType/>
                <semantics:AnyType/>
            </semantics:FunctionType>
            <semantics:Rules initialCapacity="1">
                <semantics:ExecutionRule>
                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                    <semantics:AnyType/>
                    <queries:Scope xmlns:queries="http://lang.whole.org/Queries">
                        <queries:Names initialCapacity="6">
                            <queries:Name value="focusEntityContainer"/>
                            <queries:Name value="focusEntityType"/>
                            <queries:Name value="focusEntityURI"/>
                            <queries:Name value="beforeEntityContainer"/>
                            <queries:Name value="beforeEntity"/>
                            <queries:Name value="caretEntity"/>
                        </queries:Names>
                        <queries:Block initialCapacity="7">
                            <queries:Path initialCapacity="2">
                                <queries:VariableRefStep value="focusEntity"/>
                                <queries:Filter>
                                    <queries:ParentStep/>
                                    <queries:VariableTest value="focusEntityContainer"/>
                                </queries:Filter>
                            </queries:Path>
                            <queries:Path initialCapacity="3">
                                <queries:VariableRefStep value="focusEntity"/>
                                <queries:Filter>
                                    <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    </semantics:FunctionApplication>
                                    <queries:VariableTest value="focusEntityType"/>
                                </queries:Filter>
                                <queries:Filter>
                                    <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#entityURI"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    </semantics:FunctionApplication>
                                    <queries:VariableTest value="focusEntityURI"/>
                                </queries:Filter>
                            </queries:Path>
                            <queries:Choose initialCapacity="2">
                                <queries:If>
                                    <queries:Not>
                                        <queries:Some>
                                        <queries:Path initialCapacity="2">
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                        </queries:Path>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Some>
                                    </queries:Not>
                                    <queries:Path initialCapacity="3">
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:And initialCapacity="2">
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        <queries:VariableTest value="beforeEntityContainer"/>
                                        </queries:And>
                                        </queries:Filter>
                                        <queries:Filter>
                                        <queries:ChildStep/>
                                        <queries:And initialCapacity="2">
                                        <queries:Not>
                                        <queries:ExpressionTest>
                                        <queries:FollowingSiblingStep/>
                                        </queries:ExpressionTest>
                                        </queries:Not>
                                        <queries:VariableTest value="beforeEntity"/>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:Path>
                                </queries:If>
                                <queries:Do>
                                    <queries:Path initialCapacity="3">
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                        <queries:VariableTest value="beforeEntityContainer"/>
                                        </queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:And initialCapacity="2">
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        <queries:VariableTest value="beforeEntity"/>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:Path>
                                </queries:Do>
                            </queries:Choose>
                            <queries:Delete>
                                <queries:VariableRefStep value="focusEntity"/>
                            </queries:Delete>
                            <queries:Filter>
                                <queries:Choose initialCapacity="2">
                                    <queries:CartesianUpdate>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="beforeEntity"/>
                                        <queries:ExpressionTest>
                                        <queries:Filter>
                                        <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </semantics:FunctionApplication>
                                        <queries:VariableTest value="focusEntityType"/>
                                        </queries:Filter>
                                        </queries:ExpressionTest>
                                        </queries:Filter>
                                        <queries:Block initialCapacity="2">
                                        <queries:PointwiseUpdate>
                                        <queries:VariableRefStep value="caretPosition"/>
                                        <workflows:InvokeJavaClassMethod xmlns:workflows="http://lang.whole.org/Workflows">
                                        <workflows:Text value="beforeEntity.getCaretPositions()"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:StringLiteral value="org.whole.lang.ui.util.CaretUtils"/>
                                        <workflows:StringLiteral value="getCaretPositions(org.whole.lang.ui.viewers.IEntityPartViewer, org.whole.lang.model.IEntity)"/>
                                        <workflows:Expressions initialCapacity="2">
                                        <workflows:Variable value="viewer"/>
                                        <workflows:Variable value="beforeEntity"/>
                                        </workflows:Expressions>
                                        </workflows:InvokeJavaClassMethod>
                                        </queries:PointwiseUpdate>
                                        <workflows:CreateEntity xmlns:workflows="http://lang.whole.org/Workflows">
                                        <workflows:Text value="beforeEntity+focusEntity"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:Registry value="DEFAULT"/>
                                        <workflows:Variable value="focusEntityURI"/>
                                        <workflows:Expressions initialCapacity="1">
                                        <queries:Addition>
                                        <queries:VariableRefStep value="beforeEntity"/>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        </queries:Addition>
                                        </workflows:Expressions>
                                        </workflows:CreateEntity>
                                        </queries:Block>
                                    </queries:CartesianUpdate>
                                    <queries:CartesianInsert>
                                        <queries:Placement value="INTO"/>
                                        <queries:VariableRefStep value="beforeEntityContainer"/>
                                        <queries:VariableRefStep value="focusEntity"/>
                                    </queries:CartesianInsert>
                                </queries:Choose>
                                <queries:VariableTest value="caretEntity"/>
                            </queries:Filter>
                            <queries:If>
                                <queries:Not>
                                    <queries:ExpressionTest>
                                        <workflows:InvokeJavaInstanceMethod xmlns:workflows="http://lang.whole.org/Workflows">
                                        <workflows:Text value="focusEntityContainer.wEquals(beforeEntityContainer)"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:Variable value="focusEntityContainer"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:StringLiteral value="org.whole.lang.model.IEntity"/>
                                        <workflows:StringLiteral value="wEquals(org.whole.lang.model.IEntity)"/>
                                        <workflows:Expressions initialCapacity="1">
                                        <workflows:Variable value="beforeEntityContainer"/>
                                        </workflows:Expressions>
                                        </workflows:InvokeJavaInstanceMethod>
                                    </queries:ExpressionTest>
                                </queries:Not>
                                <queries:Sequence initialCapacity="2">
                                    <queries:CartesianInsert>
                                        <queries:Placement value="INTO"/>
                                        <queries:VariableRefStep value="beforeEntityContainer"/>
                                        <queries:Delete>
                                        <queries:Path initialCapacity="2">
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                        <queries:ChildStep/>
                                        </queries:Path>
                                        </queries:Delete>
                                    </queries:CartesianInsert>
                                    <queries:Delete>
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                    </queries:Delete>
                                </queries:Sequence>
                            </queries:If>
                            <queries:VariableRefStep value="caretEntity"/>
                        </queries:Block>
                    </queries:Scope>
                </semantics:ExecutionRule>
            </semantics:Rules>
        </semantics:SemanticFunction>
        <semantics:SemanticFunction>
            <semantics:Name value="deleteEnabled"/>
            <semantics:FunctionType>
                <semantics:AnyType/>
                <semantics:LegacyType value="BOOLEAN"/>
            </semantics:FunctionType>
            <semantics:Rules initialCapacity="1">
                <semantics:ExecutionRule>
                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                    <semantics:AnyType/>
                    <queries:Scope xmlns:queries="http://lang.whole.org/Queries">
                        <queries:Names initialCapacity="1">
                            <queries:Name value="hasFollowingSiblingWithSameType"/>
                        </queries:Names>
                        <queries:Block initialCapacity="2">
                            <queries:QueryDeclaration>
                                <queries:Name value="hasFollowingSiblingWithSameType"/>
                                <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                <queries:CartesianProduct initialCapacity="2">
                                    <queries:Path initialCapacity="2">
                                        <queries:Filter>
                                        <queries:FollowingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                        <queries:Filter>
                                        <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </semantics:FunctionApplication>
                                        <queries:VariableTest value="type"/>
                                        </queries:Filter>
                                    </queries:Path>
                                    <queries:Filter>
                                        <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </semantics:FunctionApplication>
                                        <queries:VariableTest value="type"/>
                                    </queries:Filter>
                                </queries:CartesianProduct>
                            </queries:QueryDeclaration>
                            <queries:Choose initialCapacity="6">
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:NotEquals>
                                        <queries:VariableRefStep value="caretPosition"/>
                                        <queries:VariableRefStep value="caretPositions"/>
                                        </queries:NotEquals>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:NotEquals>
                                        <queries:VariableRefStep value="caretPositionStart"/>
                                        <queries:VariableRefStep value="caretPositionEnd"/>
                                        </queries:NotEquals>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:And initialCapacity="4">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:FollowingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                        </queries:ExpressionTest>
                                        <queries:Not>
                                        <queries:ExpressionTest>
                                        <queries:Call>
                                        <queries:Name value="hasFollowingSiblingWithSameType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Call>
                                        </queries:ExpressionTest>
                                        </queries:Not>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:And initialCapacity="3">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        <queries:ExpressionTest>
                                        <queries:Call>
                                        <queries:Name value="hasFollowingSiblingWithSameType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Call>
                                        </queries:ExpressionTest>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="true"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:And initialCapacity="2">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:And initialCapacity="3">
                                        <queries:KindTest value="COMPOSITE"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        <queries:ExpressionTest>
                                        <queries:Call>
                                        <queries:Name value="hasFollowingSiblingWithSameType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Call>
                                        </queries:ExpressionTest>
                                        </queries:And>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="true"/>
                                </queries:If>
                                <queries:Do>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:Do>
                            </queries:Choose>
                        </queries:Block>
                    </queries:Scope>
                </semantics:ExecutionRule>
            </semantics:Rules>
        </semantics:SemanticFunction>
        <semantics:SemanticFunction>
            <semantics:Name value="delete"/>
            <semantics:FunctionType>
                <semantics:AnyType/>
                <semantics:AnyType/>
            </semantics:FunctionType>
            <semantics:Rules initialCapacity="1">
                <semantics:ExecutionRule>
                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                    <semantics:AnyType/>
                    <queries:Scope xmlns:queries="http://lang.whole.org/Queries">
                        <queries:Names initialCapacity="5">
                            <queries:Name value="focusEntityContainer"/>
                            <queries:Name value="afterEntityContainer"/>
                            <queries:Name value="afterEntity"/>
                            <queries:Name value="afterEntityType"/>
                            <queries:Name value="afterEntityURI"/>
                        </queries:Names>
                        <queries:Block initialCapacity="7">
                            <queries:Path initialCapacity="2">
                                <queries:VariableRefStep value="focusEntity"/>
                                <queries:Filter>
                                    <queries:ParentStep/>
                                    <queries:VariableTest value="focusEntityContainer"/>
                                </queries:Filter>
                            </queries:Path>
                            <queries:Choose initialCapacity="2">
                                <queries:If>
                                    <queries:Not>
                                        <queries:Some>
                                        <queries:Path initialCapacity="2">
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:Filter>
                                        <queries:FollowingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                        </queries:Path>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Some>
                                    </queries:Not>
                                    <queries:Path initialCapacity="3">
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                        <queries:Filter>
                                        <queries:FollowingSiblingStep/>
                                        <queries:And initialCapacity="2">
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        <queries:VariableTest value="afterEntityContainer"/>
                                        </queries:And>
                                        </queries:Filter>
                                        <queries:Filter>
                                        <queries:ChildStep/>
                                        <queries:And initialCapacity="2">
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        <queries:VariableTest value="afterEntity"/>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:Path>
                                </queries:If>
                                <queries:Do>
                                    <queries:Path initialCapacity="3">
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                        <queries:VariableTest value="afterEntityContainer"/>
                                        </queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:Filter>
                                        <queries:FollowingSiblingStep/>
                                        <queries:And initialCapacity="2">
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        <queries:VariableTest value="afterEntity"/>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:Path>
                                </queries:Do>
                            </queries:Choose>
                            <queries:Delete>
                                <queries:VariableRefStep value="afterEntity"/>
                            </queries:Delete>
                            <queries:Path initialCapacity="3">
                                <queries:VariableRefStep value="afterEntity"/>
                                <queries:Filter>
                                    <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    </semantics:FunctionApplication>
                                    <queries:VariableTest value="afterEntityType"/>
                                </queries:Filter>
                                <queries:Filter>
                                    <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#entityURI"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    </semantics:FunctionApplication>
                                    <queries:VariableTest value="afterEntityURI"/>
                                </queries:Filter>
                            </queries:Path>
                            <queries:Filter>
                                <queries:Choose initialCapacity="2">
                                    <queries:CartesianUpdate>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:ExpressionTest>
                                        <queries:Filter>
                                        <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </semantics:FunctionApplication>
                                        <queries:VariableTest value="afterEntityType"/>
                                        </queries:Filter>
                                        </queries:ExpressionTest>
                                        </queries:Filter>
                                        <workflows:CreateEntity xmlns:workflows="http://lang.whole.org/Workflows">
                                        <workflows:Text value="focusEntity+afterEntity"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:Registry value="DEFAULT"/>
                                        <workflows:Variable value="afterEntityURI"/>
                                        <workflows:Expressions initialCapacity="1">
                                        <queries:Addition>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:VariableRefStep value="afterEntity"/>
                                        </queries:Addition>
                                        </workflows:Expressions>
                                        </workflows:CreateEntity>
                                    </queries:CartesianUpdate>
                                    <queries:CartesianInsert>
                                        <queries:Placement value="INTO"/>
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                        <queries:Block initialCapacity="2">
                                        <queries:PointwiseUpdate>
                                        <queries:VariableRefStep value="caretPosition"/>
                                        <queries:IntLiteral value="0"/>
                                        </queries:PointwiseUpdate>
                                        <queries:VariableRefStep value="afterEntity"/>
                                        </queries:Block>
                                    </queries:CartesianInsert>
                                </queries:Choose>
                                <queries:VariableTest value="caretEntity"/>
                            </queries:Filter>
                            <queries:If>
                                <queries:Not>
                                    <queries:ExpressionTest>
                                        <workflows:InvokeJavaInstanceMethod xmlns:workflows="http://lang.whole.org/Workflows">
                                        <workflows:Text value="focusEntityContainer.wEquals(afterEntityContainer)"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:Variable value="focusEntityContainer"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:StringLiteral value="org.whole.lang.model.IEntity"/>
                                        <workflows:StringLiteral value="wEquals(org.whole.lang.model.IEntity)"/>
                                        <workflows:Expressions initialCapacity="1">
                                        <workflows:Variable value="afterEntityContainer"/>
                                        </workflows:Expressions>
                                        </workflows:InvokeJavaInstanceMethod>
                                    </queries:ExpressionTest>
                                </queries:Not>
                                <queries:Sequence initialCapacity="2">
                                    <queries:CartesianInsert>
                                        <queries:Placement value="INTO"/>
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                        <queries:Delete>
                                        <queries:Path initialCapacity="2">
                                        <queries:VariableRefStep value="afterEntityContainer"/>
                                        <queries:ChildStep/>
                                        </queries:Path>
                                        </queries:Delete>
                                    </queries:CartesianInsert>
                                    <queries:Delete>
                                        <queries:VariableRefStep value="afterEntityContainer"/>
                                    </queries:Delete>
                                </queries:Sequence>
                            </queries:If>
                            <queries:VariableRefStep value="caretEntity"/>
                        </queries:Block>
                    </queries:Scope>
                </semantics:ExecutionRule>
            </semantics:Rules>
        </semantics:SemanticFunction>
        <semantics:SemanticFunction>
            <semantics:Name value="arrowLeftEnabled"/>
            <semantics:FunctionType>
                <semantics:AnyType/>
                <semantics:LegacyType value="BOOLEAN"/>
            </semantics:FunctionType>
            <semantics:Rules initialCapacity="1">
                <semantics:ExecutionRule>
                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                    <semantics:AnyType/>
                    <queries:Scope xmlns:queries="http://lang.whole.org/Queries">
                        <queries:Names initialCapacity="1">
                            <queries:Name value="hasPrecedingSiblingWithSameType"/>
                        </queries:Names>
                        <queries:Block initialCapacity="2">
                            <queries:QueryDeclaration>
                                <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                <queries:CartesianProduct initialCapacity="2">
                                    <queries:Path initialCapacity="2">
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                        <queries:Filter>
                                        <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </semantics:FunctionApplication>
                                        <queries:VariableTest value="type"/>
                                        </queries:Filter>
                                    </queries:Path>
                                    <queries:Filter>
                                        <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </semantics:FunctionApplication>
                                        <queries:VariableTest value="type"/>
                                    </queries:Filter>
                                </queries:CartesianProduct>
                            </queries:QueryDeclaration>
                            <queries:Choose initialCapacity="7">
                                <queries:Do>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:Do>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:NotEquals>
                                        <queries:VariableRefStep value="caretPosition"/>
                                        <queries:IntLiteral value="0"/>
                                        </queries:NotEquals>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:NotEquals>
                                        <queries:VariableRefStep value="caretPositionStart"/>
                                        <queries:VariableRefStep value="caretPositionEnd"/>
                                        </queries:NotEquals>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:And initialCapacity="4">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                        </queries:ExpressionTest>
                                        <queries:Not>
                                        <queries:ExpressionTest>
                                        <queries:Call>
                                        <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Call>
                                        </queries:ExpressionTest>
                                        </queries:Not>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:And initialCapacity="3">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        <queries:ExpressionTest>
                                        <queries:Call>
                                        <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Call>
                                        </queries:ExpressionTest>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="true"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:And initialCapacity="2">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:And initialCapacity="3">
                                        <queries:KindTest value="COMPOSITE"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        <queries:ExpressionTest>
                                        <queries:Call>
                                        <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Call>
                                        </queries:ExpressionTest>
                                        </queries:And>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="true"/>
                                </queries:If>
                                <queries:Do>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:Do>
                            </queries:Choose>
                        </queries:Block>
                    </queries:Scope>
                </semantics:ExecutionRule>
            </semantics:Rules>
        </semantics:SemanticFunction>
        <semantics:SemanticFunction>
            <semantics:Name value="arrowLeft"/>
            <semantics:FunctionType>
                <semantics:AnyType/>
                <semantics:AnyType/>
            </semantics:FunctionType>
            <semantics:Rules initialCapacity="1">
                <semantics:ExecutionRule>
                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                    <semantics:AnyType/>
                    <queries:Scope xmlns:queries="http://lang.whole.org/Queries">
                        <queries:Names initialCapacity="6">
                            <queries:Name value="focusEntityContainer"/>
                            <queries:Name value="focusEntityType"/>
                            <queries:Name value="focusEntityURI"/>
                            <queries:Name value="beforeEntityContainer"/>
                            <queries:Name value="beforeEntity"/>
                            <queries:Name value="caretEntity"/>
                        </queries:Names>
                        <queries:Block initialCapacity="7">
                            <queries:Path initialCapacity="2">
                                <queries:VariableRefStep value="focusEntity"/>
                                <queries:Filter>
                                    <queries:ParentStep/>
                                    <queries:VariableTest value="focusEntityContainer"/>
                                </queries:Filter>
                            </queries:Path>
                            <queries:Path initialCapacity="3">
                                <queries:VariableRefStep value="focusEntity"/>
                                <queries:Filter>
                                    <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    </semantics:FunctionApplication>
                                    <queries:VariableTest value="focusEntityType"/>
                                </queries:Filter>
                                <queries:Filter>
                                    <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#entityURI"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    </semantics:FunctionApplication>
                                    <queries:VariableTest value="focusEntityURI"/>
                                </queries:Filter>
                            </queries:Path>
                            <queries:Choose initialCapacity="2">
                                <queries:If>
                                    <queries:Not>
                                        <queries:Some>
                                        <queries:Path initialCapacity="2">
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                        </queries:Path>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Some>
                                    </queries:Not>
                                    <queries:Path initialCapacity="3">
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:And initialCapacity="2">
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        <queries:VariableTest value="beforeEntityContainer"/>
                                        </queries:And>
                                        </queries:Filter>
                                        <queries:Filter>
                                        <queries:ChildStep/>
                                        <queries:And initialCapacity="2">
                                        <queries:Not>
                                        <queries:ExpressionTest>
                                        <queries:FollowingSiblingStep/>
                                        </queries:ExpressionTest>
                                        </queries:Not>
                                        <queries:VariableTest value="beforeEntity"/>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:Path>
                                </queries:If>
                                <queries:Do>
                                    <queries:Path initialCapacity="3">
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                        <queries:VariableTest value="beforeEntityContainer"/>
                                        </queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:And initialCapacity="2">
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        <queries:VariableTest value="beforeEntity"/>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:Path>
                                </queries:Do>
                            </queries:Choose>
                            <queries:Delete>
                                <queries:VariableRefStep value="focusEntity"/>
                            </queries:Delete>
                            <queries:Filter>
                                <queries:Choose initialCapacity="2">
                                    <queries:CartesianUpdate>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="beforeEntity"/>
                                        <queries:ExpressionTest>
                                        <queries:Filter>
                                        <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </semantics:FunctionApplication>
                                        <queries:VariableTest value="focusEntityType"/>
                                        </queries:Filter>
                                        </queries:ExpressionTest>
                                        </queries:Filter>
                                        <queries:Block initialCapacity="2">
                                        <queries:PointwiseUpdate>
                                        <queries:VariableRefStep value="caretPosition"/>
                                        <workflows:InvokeJavaClassMethod xmlns:workflows="http://lang.whole.org/Workflows">
                                        <workflows:Text value="beforeEntity.getCaretPositions()"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:StringLiteral value="org.whole.lang.ui.util.CaretUtils"/>
                                        <workflows:StringLiteral value="getCaretPositions(org.whole.lang.ui.viewers.IEntityPartViewer, org.whole.lang.model.IEntity)"/>
                                        <workflows:Expressions initialCapacity="2">
                                        <workflows:Variable value="viewer"/>
                                        <workflows:Variable value="beforeEntity"/>
                                        </workflows:Expressions>
                                        </workflows:InvokeJavaClassMethod>
                                        </queries:PointwiseUpdate>
                                        <workflows:CreateEntity xmlns:workflows="http://lang.whole.org/Workflows">
                                        <workflows:Text value="beforeEntity+focusEntity"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:Registry value="DEFAULT"/>
                                        <workflows:Variable value="focusEntityURI"/>
                                        <workflows:Expressions initialCapacity="1">
                                        <queries:Addition>
                                        <queries:VariableRefStep value="beforeEntity"/>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        </queries:Addition>
                                        </workflows:Expressions>
                                        </workflows:CreateEntity>
                                        </queries:Block>
                                    </queries:CartesianUpdate>
                                    <queries:CartesianInsert>
                                        <queries:Placement value="INTO"/>
                                        <queries:VariableRefStep value="beforeEntityContainer"/>
                                        <queries:VariableRefStep value="focusEntity"/>
                                    </queries:CartesianInsert>
                                </queries:Choose>
                                <queries:VariableTest value="caretEntity"/>
                            </queries:Filter>
                            <queries:If>
                                <queries:Not>
                                    <queries:ExpressionTest>
                                        <workflows:InvokeJavaInstanceMethod xmlns:workflows="http://lang.whole.org/Workflows">
                                        <workflows:Text value="focusEntityContainer.wEquals(beforeEntityContainer)"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:Variable value="focusEntityContainer"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:StringLiteral value="org.whole.lang.model.IEntity"/>
                                        <workflows:StringLiteral value="wEquals(org.whole.lang.model.IEntity)"/>
                                        <workflows:Expressions initialCapacity="1">
                                        <workflows:Variable value="beforeEntityContainer"/>
                                        </workflows:Expressions>
                                        </workflows:InvokeJavaInstanceMethod>
                                    </queries:ExpressionTest>
                                </queries:Not>
                                <queries:Sequence initialCapacity="2">
                                    <queries:CartesianInsert>
                                        <queries:Placement value="INTO"/>
                                        <queries:VariableRefStep value="beforeEntityContainer"/>
                                        <queries:Delete>
                                        <queries:Path initialCapacity="2">
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                        <queries:ChildStep/>
                                        </queries:Path>
                                        </queries:Delete>
                                    </queries:CartesianInsert>
                                    <queries:Delete>
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                    </queries:Delete>
                                </queries:Sequence>
                            </queries:If>
                            <queries:VariableRefStep value="caretEntity"/>
                        </queries:Block>
                    </queries:Scope>
                </semantics:ExecutionRule>
            </semantics:Rules>
        </semantics:SemanticFunction>
        <semantics:SemanticFunction>
            <semantics:Name value="arrowRightEnabled"/>
            <semantics:FunctionType>
                <semantics:AnyType/>
                <semantics:LegacyType value="BOOLEAN"/>
            </semantics:FunctionType>
            <semantics:Rules initialCapacity="1">
                <semantics:ExecutionRule>
                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                    <semantics:AnyType/>
                    <queries:Scope xmlns:queries="http://lang.whole.org/Queries">
                        <queries:Names initialCapacity="1">
                            <queries:Name value="hasPrecedingSiblingWithSameType"/>
                        </queries:Names>
                        <queries:Block initialCapacity="2">
                            <queries:QueryDeclaration>
                                <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                <queries:CartesianProduct initialCapacity="2">
                                    <queries:Path initialCapacity="2">
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                        <queries:Filter>
                                        <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </semantics:FunctionApplication>
                                        <queries:VariableTest value="type"/>
                                        </queries:Filter>
                                    </queries:Path>
                                    <queries:Filter>
                                        <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </semantics:FunctionApplication>
                                        <queries:VariableTest value="type"/>
                                    </queries:Filter>
                                </queries:CartesianProduct>
                            </queries:QueryDeclaration>
                            <queries:Choose initialCapacity="7">
                                <queries:Do>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:Do>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:NotEquals>
                                        <queries:VariableRefStep value="caretPosition"/>
                                        <queries:IntLiteral value="0"/>
                                        </queries:NotEquals>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:NotEquals>
                                        <queries:VariableRefStep value="caretPositionStart"/>
                                        <queries:VariableRefStep value="caretPositionEnd"/>
                                        </queries:NotEquals>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:And initialCapacity="4">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                        </queries:ExpressionTest>
                                        <queries:Not>
                                        <queries:ExpressionTest>
                                        <queries:Call>
                                        <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Call>
                                        </queries:ExpressionTest>
                                        </queries:Not>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:And initialCapacity="3">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        <queries:ExpressionTest>
                                        <queries:Call>
                                        <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Call>
                                        </queries:ExpressionTest>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="true"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:And initialCapacity="2">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:And initialCapacity="3">
                                        <queries:KindTest value="COMPOSITE"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        <queries:ExpressionTest>
                                        <queries:Call>
                                        <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Call>
                                        </queries:ExpressionTest>
                                        </queries:And>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="true"/>
                                </queries:If>
                                <queries:Do>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:Do>
                            </queries:Choose>
                        </queries:Block>
                    </queries:Scope>
                </semantics:ExecutionRule>
            </semantics:Rules>
        </semantics:SemanticFunction>
        <semantics:SemanticFunction>
            <semantics:Name value="arrowRight"/>
            <semantics:FunctionType>
                <semantics:AnyType/>
                <semantics:AnyType/>
            </semantics:FunctionType>
            <semantics:Rules initialCapacity="1">
                <semantics:ExecutionRule>
                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                    <semantics:AnyType/>
                    <queries:Scope xmlns:queries="http://lang.whole.org/Queries">
                        <queries:Names initialCapacity="6">
                            <queries:Name value="focusEntityContainer"/>
                            <queries:Name value="focusEntityType"/>
                            <queries:Name value="focusEntityURI"/>
                            <queries:Name value="beforeEntityContainer"/>
                            <queries:Name value="beforeEntity"/>
                            <queries:Name value="caretEntity"/>
                        </queries:Names>
                        <queries:Block initialCapacity="7">
                            <queries:Path initialCapacity="2">
                                <queries:VariableRefStep value="focusEntity"/>
                                <queries:Filter>
                                    <queries:ParentStep/>
                                    <queries:VariableTest value="focusEntityContainer"/>
                                </queries:Filter>
                            </queries:Path>
                            <queries:Path initialCapacity="3">
                                <queries:VariableRefStep value="focusEntity"/>
                                <queries:Filter>
                                    <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    </semantics:FunctionApplication>
                                    <queries:VariableTest value="focusEntityType"/>
                                </queries:Filter>
                                <queries:Filter>
                                    <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#entityURI"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    </semantics:FunctionApplication>
                                    <queries:VariableTest value="focusEntityURI"/>
                                </queries:Filter>
                            </queries:Path>
                            <queries:Choose initialCapacity="2">
                                <queries:If>
                                    <queries:Not>
                                        <queries:Some>
                                        <queries:Path initialCapacity="2">
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                        </queries:Path>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Some>
                                    </queries:Not>
                                    <queries:Path initialCapacity="3">
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:And initialCapacity="2">
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        <queries:VariableTest value="beforeEntityContainer"/>
                                        </queries:And>
                                        </queries:Filter>
                                        <queries:Filter>
                                        <queries:ChildStep/>
                                        <queries:And initialCapacity="2">
                                        <queries:Not>
                                        <queries:ExpressionTest>
                                        <queries:FollowingSiblingStep/>
                                        </queries:ExpressionTest>
                                        </queries:Not>
                                        <queries:VariableTest value="beforeEntity"/>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:Path>
                                </queries:If>
                                <queries:Do>
                                    <queries:Path initialCapacity="3">
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                        <queries:VariableTest value="beforeEntityContainer"/>
                                        </queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:And initialCapacity="2">
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        <queries:VariableTest value="beforeEntity"/>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:Path>
                                </queries:Do>
                            </queries:Choose>
                            <queries:Delete>
                                <queries:VariableRefStep value="focusEntity"/>
                            </queries:Delete>
                            <queries:Filter>
                                <queries:Choose initialCapacity="2">
                                    <queries:CartesianUpdate>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="beforeEntity"/>
                                        <queries:ExpressionTest>
                                        <queries:Filter>
                                        <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </semantics:FunctionApplication>
                                        <queries:VariableTest value="focusEntityType"/>
                                        </queries:Filter>
                                        </queries:ExpressionTest>
                                        </queries:Filter>
                                        <queries:Block initialCapacity="2">
                                        <queries:PointwiseUpdate>
                                        <queries:VariableRefStep value="caretPosition"/>
                                        <workflows:InvokeJavaClassMethod xmlns:workflows="http://lang.whole.org/Workflows">
                                        <workflows:Text value="beforeEntity.getCaretPositions()"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:StringLiteral value="org.whole.lang.ui.util.CaretUtils"/>
                                        <workflows:StringLiteral value="getCaretPositions(org.whole.lang.ui.viewers.IEntityPartViewer, org.whole.lang.model.IEntity)"/>
                                        <workflows:Expressions initialCapacity="2">
                                        <workflows:Variable value="viewer"/>
                                        <workflows:Variable value="beforeEntity"/>
                                        </workflows:Expressions>
                                        </workflows:InvokeJavaClassMethod>
                                        </queries:PointwiseUpdate>
                                        <workflows:CreateEntity xmlns:workflows="http://lang.whole.org/Workflows">
                                        <workflows:Text value="beforeEntity+focusEntity"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:Registry value="DEFAULT"/>
                                        <workflows:Variable value="focusEntityURI"/>
                                        <workflows:Expressions initialCapacity="1">
                                        <queries:Addition>
                                        <queries:VariableRefStep value="beforeEntity"/>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        </queries:Addition>
                                        </workflows:Expressions>
                                        </workflows:CreateEntity>
                                        </queries:Block>
                                    </queries:CartesianUpdate>
                                    <queries:CartesianInsert>
                                        <queries:Placement value="INTO"/>
                                        <queries:VariableRefStep value="beforeEntityContainer"/>
                                        <queries:VariableRefStep value="focusEntity"/>
                                    </queries:CartesianInsert>
                                </queries:Choose>
                                <queries:VariableTest value="caretEntity"/>
                            </queries:Filter>
                            <queries:If>
                                <queries:Not>
                                    <queries:ExpressionTest>
                                        <workflows:InvokeJavaInstanceMethod xmlns:workflows="http://lang.whole.org/Workflows">
                                        <workflows:Text value="focusEntityContainer.wEquals(beforeEntityContainer)"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:Variable value="focusEntityContainer"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:StringLiteral value="org.whole.lang.model.IEntity"/>
                                        <workflows:StringLiteral value="wEquals(org.whole.lang.model.IEntity)"/>
                                        <workflows:Expressions initialCapacity="1">
                                        <workflows:Variable value="beforeEntityContainer"/>
                                        </workflows:Expressions>
                                        </workflows:InvokeJavaInstanceMethod>
                                    </queries:ExpressionTest>
                                </queries:Not>
                                <queries:Sequence initialCapacity="2">
                                    <queries:CartesianInsert>
                                        <queries:Placement value="INTO"/>
                                        <queries:VariableRefStep value="beforeEntityContainer"/>
                                        <queries:Delete>
                                        <queries:Path initialCapacity="2">
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                        <queries:ChildStep/>
                                        </queries:Path>
                                        </queries:Delete>
                                    </queries:CartesianInsert>
                                    <queries:Delete>
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                    </queries:Delete>
                                </queries:Sequence>
                            </queries:If>
                            <queries:VariableRefStep value="caretEntity"/>
                        </queries:Block>
                    </queries:Scope>
                </semantics:ExecutionRule>
            </semantics:Rules>
        </semantics:SemanticFunction>
        <semantics:SemanticFunction>
            <semantics:Name value="arrowUpEnabled"/>
            <semantics:FunctionType>
                <semantics:AnyType/>
                <semantics:LegacyType value="BOOLEAN"/>
            </semantics:FunctionType>
            <semantics:Rules initialCapacity="1">
                <semantics:ExecutionRule>
                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                    <semantics:AnyType/>
                    <queries:Scope xmlns:queries="http://lang.whole.org/Queries">
                        <queries:Names initialCapacity="1">
                            <queries:Name value="hasPrecedingSiblingWithSameType"/>
                        </queries:Names>
                        <queries:Block initialCapacity="2">
                            <queries:QueryDeclaration>
                                <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                <queries:CartesianProduct initialCapacity="2">
                                    <queries:Path initialCapacity="2">
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                        <queries:Filter>
                                        <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </semantics:FunctionApplication>
                                        <queries:VariableTest value="type"/>
                                        </queries:Filter>
                                    </queries:Path>
                                    <queries:Filter>
                                        <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </semantics:FunctionApplication>
                                        <queries:VariableTest value="type"/>
                                    </queries:Filter>
                                </queries:CartesianProduct>
                            </queries:QueryDeclaration>
                            <queries:Choose initialCapacity="7">
                                <queries:Do>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:Do>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:NotEquals>
                                        <queries:VariableRefStep value="caretPosition"/>
                                        <queries:IntLiteral value="0"/>
                                        </queries:NotEquals>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:NotEquals>
                                        <queries:VariableRefStep value="caretPositionStart"/>
                                        <queries:VariableRefStep value="caretPositionEnd"/>
                                        </queries:NotEquals>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:And initialCapacity="4">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                        </queries:ExpressionTest>
                                        <queries:Not>
                                        <queries:ExpressionTest>
                                        <queries:Call>
                                        <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Call>
                                        </queries:ExpressionTest>
                                        </queries:Not>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:And initialCapacity="3">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        <queries:ExpressionTest>
                                        <queries:Call>
                                        <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Call>
                                        </queries:ExpressionTest>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="true"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:And initialCapacity="2">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:And initialCapacity="3">
                                        <queries:KindTest value="COMPOSITE"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        <queries:ExpressionTest>
                                        <queries:Call>
                                        <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Call>
                                        </queries:ExpressionTest>
                                        </queries:And>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="true"/>
                                </queries:If>
                                <queries:Do>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:Do>
                            </queries:Choose>
                        </queries:Block>
                    </queries:Scope>
                </semantics:ExecutionRule>
            </semantics:Rules>
        </semantics:SemanticFunction>
        <semantics:SemanticFunction>
            <semantics:Name value="arrowUp"/>
            <semantics:FunctionType>
                <semantics:AnyType/>
                <semantics:AnyType/>
            </semantics:FunctionType>
            <semantics:Rules initialCapacity="1">
                <semantics:ExecutionRule>
                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                    <semantics:AnyType/>
                    <queries:Scope xmlns:queries="http://lang.whole.org/Queries">
                        <queries:Names initialCapacity="6">
                            <queries:Name value="focusEntityContainer"/>
                            <queries:Name value="focusEntityType"/>
                            <queries:Name value="focusEntityURI"/>
                            <queries:Name value="beforeEntityContainer"/>
                            <queries:Name value="beforeEntity"/>
                            <queries:Name value="caretEntity"/>
                        </queries:Names>
                        <queries:Block initialCapacity="7">
                            <queries:Path initialCapacity="2">
                                <queries:VariableRefStep value="focusEntity"/>
                                <queries:Filter>
                                    <queries:ParentStep/>
                                    <queries:VariableTest value="focusEntityContainer"/>
                                </queries:Filter>
                            </queries:Path>
                            <queries:Path initialCapacity="3">
                                <queries:VariableRefStep value="focusEntity"/>
                                <queries:Filter>
                                    <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    </semantics:FunctionApplication>
                                    <queries:VariableTest value="focusEntityType"/>
                                </queries:Filter>
                                <queries:Filter>
                                    <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#entityURI"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    </semantics:FunctionApplication>
                                    <queries:VariableTest value="focusEntityURI"/>
                                </queries:Filter>
                            </queries:Path>
                            <queries:Choose initialCapacity="2">
                                <queries:If>
                                    <queries:Not>
                                        <queries:Some>
                                        <queries:Path initialCapacity="2">
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                        </queries:Path>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Some>
                                    </queries:Not>
                                    <queries:Path initialCapacity="3">
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:And initialCapacity="2">
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        <queries:VariableTest value="beforeEntityContainer"/>
                                        </queries:And>
                                        </queries:Filter>
                                        <queries:Filter>
                                        <queries:ChildStep/>
                                        <queries:And initialCapacity="2">
                                        <queries:Not>
                                        <queries:ExpressionTest>
                                        <queries:FollowingSiblingStep/>
                                        </queries:ExpressionTest>
                                        </queries:Not>
                                        <queries:VariableTest value="beforeEntity"/>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:Path>
                                </queries:If>
                                <queries:Do>
                                    <queries:Path initialCapacity="3">
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                        <queries:VariableTest value="beforeEntityContainer"/>
                                        </queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:And initialCapacity="2">
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        <queries:VariableTest value="beforeEntity"/>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:Path>
                                </queries:Do>
                            </queries:Choose>
                            <queries:Delete>
                                <queries:VariableRefStep value="focusEntity"/>
                            </queries:Delete>
                            <queries:Filter>
                                <queries:Choose initialCapacity="2">
                                    <queries:CartesianUpdate>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="beforeEntity"/>
                                        <queries:ExpressionTest>
                                        <queries:Filter>
                                        <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </semantics:FunctionApplication>
                                        <queries:VariableTest value="focusEntityType"/>
                                        </queries:Filter>
                                        </queries:ExpressionTest>
                                        </queries:Filter>
                                        <queries:Block initialCapacity="2">
                                        <queries:PointwiseUpdate>
                                        <queries:VariableRefStep value="caretPosition"/>
                                        <workflows:InvokeJavaClassMethod xmlns:workflows="http://lang.whole.org/Workflows">
                                        <workflows:Text value="beforeEntity.getCaretPositions()"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:StringLiteral value="org.whole.lang.ui.util.CaretUtils"/>
                                        <workflows:StringLiteral value="getCaretPositions(org.whole.lang.ui.viewers.IEntityPartViewer, org.whole.lang.model.IEntity)"/>
                                        <workflows:Expressions initialCapacity="2">
                                        <workflows:Variable value="viewer"/>
                                        <workflows:Variable value="beforeEntity"/>
                                        </workflows:Expressions>
                                        </workflows:InvokeJavaClassMethod>
                                        </queries:PointwiseUpdate>
                                        <workflows:CreateEntity xmlns:workflows="http://lang.whole.org/Workflows">
                                        <workflows:Text value="beforeEntity+focusEntity"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:Registry value="DEFAULT"/>
                                        <workflows:Variable value="focusEntityURI"/>
                                        <workflows:Expressions initialCapacity="1">
                                        <queries:Addition>
                                        <queries:VariableRefStep value="beforeEntity"/>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        </queries:Addition>
                                        </workflows:Expressions>
                                        </workflows:CreateEntity>
                                        </queries:Block>
                                    </queries:CartesianUpdate>
                                    <queries:CartesianInsert>
                                        <queries:Placement value="INTO"/>
                                        <queries:VariableRefStep value="beforeEntityContainer"/>
                                        <queries:VariableRefStep value="focusEntity"/>
                                    </queries:CartesianInsert>
                                </queries:Choose>
                                <queries:VariableTest value="caretEntity"/>
                            </queries:Filter>
                            <queries:If>
                                <queries:Not>
                                    <queries:ExpressionTest>
                                        <workflows:InvokeJavaInstanceMethod xmlns:workflows="http://lang.whole.org/Workflows">
                                        <workflows:Text value="focusEntityContainer.wEquals(beforeEntityContainer)"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:Variable value="focusEntityContainer"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:StringLiteral value="org.whole.lang.model.IEntity"/>
                                        <workflows:StringLiteral value="wEquals(org.whole.lang.model.IEntity)"/>
                                        <workflows:Expressions initialCapacity="1">
                                        <workflows:Variable value="beforeEntityContainer"/>
                                        </workflows:Expressions>
                                        </workflows:InvokeJavaInstanceMethod>
                                    </queries:ExpressionTest>
                                </queries:Not>
                                <queries:Sequence initialCapacity="2">
                                    <queries:CartesianInsert>
                                        <queries:Placement value="INTO"/>
                                        <queries:VariableRefStep value="beforeEntityContainer"/>
                                        <queries:Delete>
                                        <queries:Path initialCapacity="2">
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                        <queries:ChildStep/>
                                        </queries:Path>
                                        </queries:Delete>
                                    </queries:CartesianInsert>
                                    <queries:Delete>
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                    </queries:Delete>
                                </queries:Sequence>
                            </queries:If>
                            <queries:VariableRefStep value="caretEntity"/>
                        </queries:Block>
                    </queries:Scope>
                </semantics:ExecutionRule>
            </semantics:Rules>
        </semantics:SemanticFunction>
        <semantics:SemanticFunction>
            <semantics:Name value="arrowDownEnabled"/>
            <semantics:FunctionType>
                <semantics:AnyType/>
                <semantics:LegacyType value="BOOLEAN"/>
            </semantics:FunctionType>
            <semantics:Rules initialCapacity="1">
                <semantics:ExecutionRule>
                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                    <semantics:AnyType/>
                    <queries:Scope xmlns:queries="http://lang.whole.org/Queries">
                        <queries:Names initialCapacity="1">
                            <queries:Name value="hasPrecedingSiblingWithSameType"/>
                        </queries:Names>
                        <queries:Block initialCapacity="2">
                            <queries:QueryDeclaration>
                                <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                <queries:CartesianProduct initialCapacity="2">
                                    <queries:Path initialCapacity="2">
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                        <queries:Filter>
                                        <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </semantics:FunctionApplication>
                                        <queries:VariableTest value="type"/>
                                        </queries:Filter>
                                    </queries:Path>
                                    <queries:Filter>
                                        <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </semantics:FunctionApplication>
                                        <queries:VariableTest value="type"/>
                                    </queries:Filter>
                                </queries:CartesianProduct>
                            </queries:QueryDeclaration>
                            <queries:Choose initialCapacity="7">
                                <queries:Do>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:Do>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:NotEquals>
                                        <queries:VariableRefStep value="caretPosition"/>
                                        <queries:IntLiteral value="0"/>
                                        </queries:NotEquals>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:NotEquals>
                                        <queries:VariableRefStep value="caretPositionStart"/>
                                        <queries:VariableRefStep value="caretPositionEnd"/>
                                        </queries:NotEquals>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:And initialCapacity="4">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                        </queries:ExpressionTest>
                                        <queries:Not>
                                        <queries:ExpressionTest>
                                        <queries:Call>
                                        <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Call>
                                        </queries:ExpressionTest>
                                        </queries:Not>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:And initialCapacity="3">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        <queries:ExpressionTest>
                                        <queries:Call>
                                        <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Call>
                                        </queries:ExpressionTest>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="true"/>
                                </queries:If>
                                <queries:If>
                                    <queries:ExpressionTest>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:And initialCapacity="2">
                                        <queries:KindTest value="DATA"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:And initialCapacity="3">
                                        <queries:KindTest value="COMPOSITE"/>
                                        <queries:ExpressionTest>
                                        <queries:Path initialCapacity="1">
                                        <queries:Filter>
                                        <queries:ParentStep/>
                                        <queries:KindTest value="COMPOSITE"/>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        <queries:ExpressionTest>
                                        <queries:Call>
                                        <queries:Name value="hasPrecedingSiblingWithSameType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Call>
                                        </queries:ExpressionTest>
                                        </queries:And>
                                        </queries:Filter>
                                        </queries:Path>
                                        </queries:ExpressionTest>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:ExpressionTest>
                                    <queries:BooleanLiteral value="true"/>
                                </queries:If>
                                <queries:Do>
                                    <queries:BooleanLiteral value="false"/>
                                </queries:Do>
                            </queries:Choose>
                        </queries:Block>
                    </queries:Scope>
                </semantics:ExecutionRule>
            </semantics:Rules>
        </semantics:SemanticFunction>
        <semantics:SemanticFunction>
            <semantics:Name value="arrowDown"/>
            <semantics:FunctionType>
                <semantics:AnyType/>
                <semantics:AnyType/>
            </semantics:FunctionType>
            <semantics:Rules initialCapacity="1">
                <semantics:ExecutionRule>
                    <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                    <semantics:AnyType/>
                    <queries:Scope xmlns:queries="http://lang.whole.org/Queries">
                        <queries:Names initialCapacity="6">
                            <queries:Name value="focusEntityContainer"/>
                            <queries:Name value="focusEntityType"/>
                            <queries:Name value="focusEntityURI"/>
                            <queries:Name value="beforeEntityContainer"/>
                            <queries:Name value="beforeEntity"/>
                            <queries:Name value="caretEntity"/>
                        </queries:Names>
                        <queries:Block initialCapacity="7">
                            <queries:Path initialCapacity="2">
                                <queries:VariableRefStep value="focusEntity"/>
                                <queries:Filter>
                                    <queries:ParentStep/>
                                    <queries:VariableTest value="focusEntityContainer"/>
                                </queries:Filter>
                            </queries:Path>
                            <queries:Path initialCapacity="3">
                                <queries:VariableRefStep value="focusEntity"/>
                                <queries:Filter>
                                    <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    </semantics:FunctionApplication>
                                    <queries:VariableTest value="focusEntityType"/>
                                </queries:Filter>
                                <queries:Filter>
                                    <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#entityURI"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                    </semantics:FunctionApplication>
                                    <queries:VariableTest value="focusEntityURI"/>
                                </queries:Filter>
                            </queries:Path>
                            <queries:Choose initialCapacity="2">
                                <queries:If>
                                    <queries:Not>
                                        <queries:Some>
                                        <queries:Path initialCapacity="2">
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        </queries:Filter>
                                        </queries:Path>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </queries:Some>
                                    </queries:Not>
                                    <queries:Path initialCapacity="3">
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:And initialCapacity="2">
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        <queries:VariableTest value="beforeEntityContainer"/>
                                        </queries:And>
                                        </queries:Filter>
                                        <queries:Filter>
                                        <queries:ChildStep/>
                                        <queries:And initialCapacity="2">
                                        <queries:Not>
                                        <queries:ExpressionTest>
                                        <queries:FollowingSiblingStep/>
                                        </queries:ExpressionTest>
                                        </queries:Not>
                                        <queries:VariableTest value="beforeEntity"/>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:Path>
                                </queries:If>
                                <queries:Do>
                                    <queries:Path initialCapacity="3">
                                        <queries:Filter>
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                        <queries:VariableTest value="beforeEntityContainer"/>
                                        </queries:Filter>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        <queries:Filter>
                                        <queries:PrecedingSiblingStep/>
                                        <queries:And initialCapacity="2">
                                        <queries:IndexTest>
                                        <queries:IntLiteral value="0"/>
                                        </queries:IndexTest>
                                        <queries:VariableTest value="beforeEntity"/>
                                        </queries:And>
                                        </queries:Filter>
                                    </queries:Path>
                                </queries:Do>
                            </queries:Choose>
                            <queries:Delete>
                                <queries:VariableRefStep value="focusEntity"/>
                            </queries:Delete>
                            <queries:Filter>
                                <queries:Choose initialCapacity="2">
                                    <queries:CartesianUpdate>
                                        <queries:Filter>
                                        <queries:VariableRefStep value="beforeEntity"/>
                                        <queries:ExpressionTest>
                                        <queries:Filter>
                                        <semantics:FunctionApplication>
                                        <semantics:Name value="whole:org.whole.lang:ReflectLibrary#instanceType"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        </semantics:FunctionApplication>
                                        <queries:VariableTest value="focusEntityType"/>
                                        </queries:Filter>
                                        </queries:ExpressionTest>
                                        </queries:Filter>
                                        <queries:Block initialCapacity="2">
                                        <queries:PointwiseUpdate>
                                        <queries:VariableRefStep value="caretPosition"/>
                                        <workflows:InvokeJavaClassMethod xmlns:workflows="http://lang.whole.org/Workflows">
                                        <workflows:Text value="beforeEntity.getCaretPositions()"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:StringLiteral value="org.whole.lang.ui.util.CaretUtils"/>
                                        <workflows:StringLiteral value="getCaretPositions(org.whole.lang.ui.viewers.IEntityPartViewer, org.whole.lang.model.IEntity)"/>
                                        <workflows:Expressions initialCapacity="2">
                                        <workflows:Variable value="viewer"/>
                                        <workflows:Variable value="beforeEntity"/>
                                        </workflows:Expressions>
                                        </workflows:InvokeJavaClassMethod>
                                        </queries:PointwiseUpdate>
                                        <workflows:CreateEntity xmlns:workflows="http://lang.whole.org/Workflows">
                                        <workflows:Text value="beforeEntity+focusEntity"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:Registry value="DEFAULT"/>
                                        <workflows:Variable value="focusEntityURI"/>
                                        <workflows:Expressions initialCapacity="1">
                                        <queries:Addition>
                                        <queries:VariableRefStep value="beforeEntity"/>
                                        <queries:VariableRefStep value="focusEntity"/>
                                        </queries:Addition>
                                        </workflows:Expressions>
                                        </workflows:CreateEntity>
                                        </queries:Block>
                                    </queries:CartesianUpdate>
                                    <queries:CartesianInsert>
                                        <queries:Placement value="INTO"/>
                                        <queries:VariableRefStep value="beforeEntityContainer"/>
                                        <queries:VariableRefStep value="focusEntity"/>
                                    </queries:CartesianInsert>
                                </queries:Choose>
                                <queries:VariableTest value="caretEntity"/>
                            </queries:Filter>
                            <queries:If>
                                <queries:Not>
                                    <queries:ExpressionTest>
                                        <workflows:InvokeJavaInstanceMethod xmlns:workflows="http://lang.whole.org/Workflows">
                                        <workflows:Text value="focusEntityContainer.wEquals(beforeEntityContainer)"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:Variable value="focusEntityContainer"/>
                                        <commons:Resolver xmlns:commons="http://lang.whole.org/Commons"/>
                                        <workflows:StringLiteral value="org.whole.lang.model.IEntity"/>
                                        <workflows:StringLiteral value="wEquals(org.whole.lang.model.IEntity)"/>
                                        <workflows:Expressions initialCapacity="1">
                                        <workflows:Variable value="beforeEntityContainer"/>
                                        </workflows:Expressions>
                                        </workflows:InvokeJavaInstanceMethod>
                                    </queries:ExpressionTest>
                                </queries:Not>
                                <queries:Sequence initialCapacity="2">
                                    <queries:CartesianInsert>
                                        <queries:Placement value="INTO"/>
                                        <queries:VariableRefStep value="beforeEntityContainer"/>
                                        <queries:Delete>
                                        <queries:Path initialCapacity="2">
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                        <queries:ChildStep/>
                                        </queries:Path>
                                        </queries:Delete>
                                    </queries:CartesianInsert>
                                    <queries:Delete>
                                        <queries:VariableRefStep value="focusEntityContainer"/>
                                    </queries:Delete>
                                </queries:Sequence>
                            </queries:If>
                            <queries:VariableRefStep value="caretEntity"/>
                        </queries:Block>
                    </queries:Scope>
                </semantics:ExecutionRule>
            </semantics:Rules>
        </semantics:SemanticFunction>
    </semantics:SemanticFunctions>
</semantics:SemanticTheory>
